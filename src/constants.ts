/* SQUARE REPRESENTATION */

export const SQUARE = {
  EMPTY: 0b0000_0000,        // = 0
  EDGE:  0b1000_0000,        // = 128
}

export const PIECE = {
  PAWN:      0b0000_0001,        // = 1
  KNIGHT:    0b0000_0010,        // = 2
  BISHOP:    0b0000_0011,        // = 3
  ROOK:      0b0000_0100,        // = 4
  QUEEN:     0b0000_0101,        // = 5
  KING:      0b0000_0110,        // = 6
  HAS_MOVED: 0b0000_1000,        // = 8
  IS_WHITE:  0b0001_0000,        // = 16
  IS_BLACK:  0b0010_0000,        // = 32
}

export const PIECE_MASK = {
  TYPE:   0b0000_0111,
  COLOUR: 0b0011_0000,
}

export const PROMOTION_PIECES = [PIECE.KNIGHT, PIECE.BISHOP, PIECE.QUEEN];

export const PIECE_LOOKUP: Record<string, number> = {
  P: PIECE.PAWN,
  N: PIECE.KNIGHT,
  B: PIECE.BISHOP,
  R: PIECE.ROOK,
  Q: PIECE.QUEEN,
  K: PIECE.KING,
};

export const SQUARE_ASCII: Record<number, string> = {
  0b0000_0000: ".",   // Empty
  0b0001_0001: "P",   // Pawn White
  0b0001_0010: "N",   // Knight White
  0b0001_0011: "B",   // Bishop White
  0b0001_0100: "R",   // Rook White
  0b0001_0101: "Q",   // Queen White
  0b0001_0110: "K",   // King White
  0b0010_0001: "p",   // Pawn Black
  0b0010_0010: "n",   // Knight Black
  0b0010_0011: "b",   // Bishop Black
  0b0010_0100: "r",   // Rook Black
  0b0010_0101: "q",   // Queen Black
  0b0010_0110: "k",   // King Black
};


/* FEN */

export const DEFAULT_FEN = "rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1"; 


/* MAILBOX */

export const MAILBOX64 = new Int8Array([
  21, 22, 23, 24, 25, 26, 27, 28,
  31, 32, 33, 34, 35, 36, 37, 38,
  41, 42, 43, 44, 45, 46, 47, 48,
  51, 52, 53, 54, 55, 56, 57, 58,
  61, 62, 63, 64, 65, 66, 67, 68,
  71, 72, 73, 74, 75, 76, 77, 78,
  81, 82, 83, 84, 85, 86, 87, 88,
  91, 92, 93, 94, 95, 96, 97, 98
]);

const EDGE = SQUARE.EDGE;
export const MAILBOX120 = new Int8Array([
  EDGE, EDGE, EDGE, EDGE, EDGE, EDGE, EDGE, EDGE, EDGE, EDGE,
  EDGE, EDGE, EDGE, EDGE, EDGE, EDGE, EDGE, EDGE, EDGE, EDGE,
  EDGE,    0,    1,    2,    3,    4,    5,    6,    7, EDGE,
  EDGE,    8,    9,   10,   11,   12,   13,   14,   15, EDGE,
  EDGE,   16,   17,   18,   19,   20,   21,   22,   23, EDGE,
  EDGE,   24,   25,   26,   27,   28,   29,   30,   31, EDGE,
  EDGE,   32,   33,   34,   35,   36,   37,   38,   39, EDGE,
  EDGE,   40,   41,   42,   43,   44,   45,   46,   47, EDGE,
  EDGE,   48,   49,   50,   51,   52,   53,   54,   55, EDGE,
  EDGE,   56,   57,   58,   59,   60,   61,   62,   63, EDGE,
  EDGE, EDGE, EDGE, EDGE, EDGE, EDGE, EDGE, EDGE, EDGE, EDGE,
  EDGE, EDGE, EDGE, EDGE, EDGE, EDGE, EDGE, EDGE, EDGE, EDGE,
]);


/* DIRECTIONS */

export const DIRECTION = {
  NORTH: -10,
  SOUTH: 10,
  EAST: 1,
  WEST: -1,
  NORTHEAST: -9,
  NORTHWEST: -11,
  SOUTHEAST: 11,
  SOUTHWEST: 9,
}


/* MOVE LIST */

export const MOVE_LIST = [
  /* black pawn */  [(DIRECTION.SOUTH), (2*DIRECTION.SOUTH), (DIRECTION.SOUTHEAST), (DIRECTION.SOUTHWEST)],
  /* white pawn */  [(DIRECTION.NORTH), (2*DIRECTION.NORTH), (DIRECTION.NORTHEAST), (DIRECTION.NORTHWEST)],
  /*     knight */  [(DIRECTION.NORTH+DIRECTION.NORTHEAST), (DIRECTION.NORTH+DIRECTION.NORTHWEST), (DIRECTION.EAST+DIRECTION.NORTHEAST), (DIRECTION.EAST+DIRECTION.SOUTHEAST), (DIRECTION.SOUTH+DIRECTION.SOUTHEAST), (DIRECTION.SOUTH+DIRECTION.SOUTHWEST), (DIRECTION.WEST+DIRECTION.NORTHWEST), (DIRECTION.WEST+DIRECTION.SOUTHWEST)],
  /*     bishop */  [(DIRECTION.NORTHEAST), (DIRECTION.NORTHWEST), (DIRECTION.SOUTHEAST), (DIRECTION.SOUTHWEST)],
  /*       rook */  [(DIRECTION.NORTH), (DIRECTION.SOUTH), (DIRECTION.EAST), (DIRECTION.WEST)],
  /*      queen */  [(DIRECTION.NORTH), (DIRECTION.SOUTH), (DIRECTION.EAST), (DIRECTION.WEST), (DIRECTION.NORTHEAST), (DIRECTION.NORTHWEST), (DIRECTION.SOUTHEAST), (DIRECTION.SOUTHWEST)],
  /*       king */  [(DIRECTION.NORTH), (DIRECTION.SOUTH), (DIRECTION.EAST), (DIRECTION.WEST), (DIRECTION.NORTHEAST), (DIRECTION.NORTHWEST), (DIRECTION.SOUTHEAST), (DIRECTION.SOUTHWEST)],
];

export const SLIDERS = [
  /* black pawn */ false,
  /* white pawn */ false,
  /*     knight */ false,
  /*     bishop */ true,
  /*       rook */ true,
  /*      queen */ true,
  /*       king */ false,
];

export const CASTLE_INDEXES = {
  KING_TO_KINGSIDE: 2 * DIRECTION.EAST,
  KING_TO_QUEENSIDE: 2 * DIRECTION.WEST,
  ROOK_TO_KINGSIDE: 2 * DIRECTION.WEST,
  ROOK_TO_QUEENSIDE: 3 * DIRECTION.EAST,
};


/* MOVE ENCODING */

export const ENCODED_MOVE = {
  FROM_INDEX:             0b0000_0000_0000_0000_0000_0000_1111_1111,  // << 0
  TO_INDEX:               0b0000_0000_0000_0000_1111_1111_0000_0000,  // << 8
  PIECE_CAPTURE:          0b0000_0000_0011_1111_0000_0000_0000_0000,  // << 16
  PIECE_FROM_HAS_MOVED:   0b0000_0001_0000_0000_0000_0000_0000_0000,  // << 24
  PROMOTION_TO:           0b0000_1110_0000_0000_0000_0000_0000_0000,  // << 25
  EN_PASSANT_MOVE:        0b0001_0000_0000_0000_0000_0000_0000_0000,  // << 28
  DOUBLE_PUSH_MOVE:       0b0010_0000_0000_0000_0000_0000_0000_0000,  // << 29
  KINGSIDE_CASTLE_MOVE:   0b0100_0000_0000_0000_0000_0000_0000_0000,  // << 30
  QUEENSIDE_CASTLE_MOVE:  0b1000_0000_0000_0000_0000_0000_0000_0000,  // << 31
}


/* BOARD STATE */

export const BOARD_STATES = {
  EMPTY:                    0b0000_0000_0000_0000_0000_0000_0000_0000,
  HALFMOVE_CLOCK:           0b0000_0000_0000_0000_0000_0000_0111_1111,
  EN_PASSANT_SQUARE:        0b0000_0000_0000_0000_1111_1111_0000_0000,
  CASTLE_RIGHTS:            0b0000_0000_0000_1111_0000_0000_0000_0000,
  WHITE_KINGSIDE_CASTLE:    0b0000_0000_0000_1000_0000_0000_0000_0000,
  WHITE_QUEENSIDE_CASTLE:   0b0000_0000_0000_0100_0000_0000_0000_0000,
  BLACK_KINGSIDE_CASTLE:    0b0000_0000_0000_0010_0000_0000_0000_0000,
  BLACK_QUEENSIDE_CASTLE:   0b0000_0000_0000_0001_0000_0000_0000_0000,
  CURRENT_TURN:             0b0000_0000_0011_0000_0000_0000_0000_0000,
  CURRENT_TURN_WHITE:       0b0000_0000_0001_0000_0000_0000_0000_0000,
  CURRENT_TURN_BLACK:       0b0000_0000_0010_0000_0000_0000_0000_0000,
}